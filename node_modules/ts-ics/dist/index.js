var Fe={ACTION:"action",DESCRIPTION:"description",DURATION:"duration",REPEAT:"repeat",SUMMARY:"summary",TRIGGER:"trigger",ATTACH:"attachment",ATTENDEE:"attendee"},$e={action:"ACTION",description:"DESCRIPTION",duration:"DURATION",repeat:"REPEAT",summary:"SUMMARY",trigger:"TRIGGER",attachment:"ATTACH",attendee:"ATTENDEE"};import it from"lodash/compact";var qe={METHOD:"method",PRODID:"prodId",VERSION:"version"},Je={method:"METHOD",prodId:"PRODID",version:"VERSION"};var Oe="BEGIN",De="END",Ge="VCALENDAR",Ae="VTIMEZONE",xe="STANDARD",Ie="DAYLIGHT",Ve="VEVENT",Se="VALARM";var G=e=>new RegExp(`${Oe}:${e}([\\s\\S]*?)${De}:${e}`,"g"),Ne=G(Ae),ze=G(xe),Me=G(Ie),Ke=G(Ve),he=G(Se),_=e=>new RegExp(`${Oe}:${e}|${De}:${e}`,"g"),Qe=_(Ge),Xe=_(Ae),et=_(xe),tt=_(Ie),rt=_(Ve),nt=_(Se);var re=/\r\n|\r|\n/,ne=`\r
`,ot=":",k=",",st='"',Y=";";var Q="=";var oe=e=>`${e}${ne}`,m=(e,t,n)=>n?t==null?"":oe(`${e};${n}:${t}`):oe(`${e}:${t}`),b=e=>oe(`BEGIN:${e}`),O=e=>oe(`END:${e}`);var g=e=>{if(!(e.length<1))return`${e.map(t=>`${t.key}${Q}${t.value}`).join(Y)}`};var at=e=>{if(e.type==="uri"){let t=g(it([e.formatType&&{key:"FMTTYPE",value:e.formatType}]));return m("ATTACH",e.url,t)}if(e.type==="binary"){let t=g(it([e.value&&{key:"VALUE",value:e.value},e.encoding&&{key:"ENCODING",value:e.encoding}]));return m("ATTACH",e.binary,t)}throw Error(`Attachment has no type! ${JSON.stringify(e)}`)};import qt from"lodash/compact";var N=(e,t)=>t?`"MAILTO:${e}"`:`MAILTO:${e}`;var se=(e,t)=>{let n=g(qt([e.dir&&{key:"DIR",value:`"${e.dir}"`},e.delegatedFrom&&{key:"DELEGATED-FROM",value:N(e.delegatedFrom,!0)},e.member&&{key:"MEMBER",value:N(e.member,!0)},e.role&&{key:"ROLE",value:e.role},e.name&&{key:"CN",value:e.name},e.partstat&&{key:"PARTSTAT",value:e.partstat},e.role&&{key:"ROLE",value:e.role},e.sentBy&&{key:"SENT-BY",value:N(e.sentBy,!0)}]));return m(t,N(e.email),n)};var U=e=>{let t="";return e.before&&(t+="-"),t+="P",e.weeks&&(t+=`${e.weeks}W`),e.days&&(t+=`${e.days}D`),(e.hours||e.minutes||e.seconds)&&(t+="T",e.hours&&(t+=`${e.hours}H`),e.minutes&&(t+=`${e.minutes}M`),e.seconds&&(t+=`${e.seconds}S`)),t};import Gt from"lodash/compact";import Jt from"lodash/compact";import ct from"lodash/isDate";var pt=e=>{if(!ct(e))throw Error(`Incorrect date object: ${e}`);let t=e.toISOString(),n=t.slice(0,4),r=t.slice(5,7),o=t.slice(8,10);return`${n}${r}${o}`},W=e=>{if(!ct(e))throw Error(`Incorrect date object: ${e}`);let t=e.toISOString(),n=t.slice(0,4),r=t.slice(5,7),o=t.slice(8,10),s=t.slice(11,13),i=t.slice(14,16),a=t.slice(17,19);return`${n}${r}${o}T${s}${i}${a}Z`};var Z=(e,t)=>{var o;let n=t.type==="DATE"?pt(t.date):W(((o=t.local)==null?void 0:o.date)||t.date),r=g(Jt([t.type&&{key:"VALUE",value:t.type},t.local&&{key:"TZID",value:t.local.timezone}]));return m(e,n,r)};var mt=e=>{var n;let t=g(Gt([((n=e.options)==null?void 0:n.related)&&{key:"RELATED",value:e.options.related}]));if(e.type==="absolute")return Z("TRIGGER",e.value);if(e.type==="relative")return m("TRIGGER",U(e.value),t)};var D=e=>Object.keys(e);var ut=e=>{let t=D(e),n="";return n+=b("VALARM"),t.forEach(r=>{if(r==="attachments"||r==="attendees")return;let o=$e[r];if(!o)return;let s=e[r];if(s&&s!=null){if(r==="trigger"){n+=mt(s);return}if(r==="duration"){n+=m(o,U(s));return}if(r==="repeat"){n+=m(o,s==null?void 0:s.toString());return}n+=m(o,String(s))}}),e.attachments&&e.attachments.length>0&&e.attachments.forEach(r=>{n+=at(r)}),e.attendees&&e.attendees.length>0&&e.attendees.forEach(r=>{n+=se(r,"ATTENDEE")}),n+=O("VALARM"),n};var yt={"LAST-MODIFIED":"lastModified",ALARM:"alarm",CATEGORIES:"categories",CREATED:"created",DESCRIPTION:"description",DTSTAMP:"stamp",DTSTART:"start",LOCATION:"location",RRULE:"recurrenceRule",SUMMARY:"summary",UID:"uid",TRANSP:"timeTransparent",URL:"url",DTEND:"end",DURATION:"duration",GEO:"geo",CLASS:"class",ORGANIZER:"organizer",PRIORITY:"priority",SEQ:"sequence",STATUS:"status",ATTACH:"attach","RECURRENCE-ID":"recurrenceId",ATTENDEE:"attendee",COMMENT:"comment"},Tt={alarm:"ALARM",categories:"CATEGORIES",created:"CREATED",description:"DESCRIPTION",lastModified:"LAST-MODIFIED",location:"LOCATION",recurrenceRule:"RRULE",stamp:"DTSTAMP",start:"DTSTART",summary:"SUMMARY",uid:"UID",timeTransparent:"TRANSP",url:"URL",end:"DTEND",duration:"DURATION",geo:"GEO",class:"CLASS",organizer:"ORGANIZER",priority:"PRIORITY",sequence:"SEQ",status:"STATUS",attach:"ATTACH",recurrenceId:"RECURRENCE-ID",attendee:"ATTENDEE",comment:"COMMENT"};var Qt=["stamp","start","end","created","lastModified"],ie=e=>Qt.includes(e),Xt=["categories"],ae=e=>Xt.includes(e);import er from"lodash/compact";var ft=e=>{let t=g(er([e.dir&&{key:"DIR",value:`"${e.dir}"`},e.name&&{key:"CN",value:e.name},e.sentBy&&{key:"SENT-BY",value:N(e.sentBy)}]));return m("ORGANIZER",N(e.email),t)};import Et from"lodash/compact";var lt=e=>e.occurence?`${e.occurence}${e.day}`:e.day;var ce=e=>{let t="",n=g(Et([e.byDay&&{key:"BYDAY",value:e.byDay.map(r=>lt(r)).join(",")},e.byHour&&{key:"BYHOUR",value:e.byHour.join(",")},e.byMinute&&{key:"BYMINUTE",value:e.byMinute.join(",")},e.byMonth&&{key:"BYMONTH",value:e.byMonth.map(r=>r+1).join(",")},e.byMonthday&&{key:"BYMONTHDAY",value:e.byMonthday.join(",")},e.bySecond&&{key:"BYSECOND",value:e.bySecond.join(",")},e.bySetPos&&{key:"BYSETPOS",value:e.bySetPos.join(",")},e.byWeekNo&&{key:"BYWEEKNO",value:e.byWeekNo.join(",")},e.byYearday&&{key:"BYYEARDAY",value:e.byYearday.join(",")},e.count&&{key:"COUNT",value:e.count.toString()},e.frequency&&{key:"FREQ",value:e.frequency},e.interval&&{key:"INTERVAL",value:e.interval.toString()},e.until&&{key:"UNTIL",value:`${e.until.local&&`${g(Et([{key:"TZID",value:e.until.local.timezone}]))}=`}${e.until.date}`},e.workweekStart&&{key:"WKST",value:e.workweekStart}]));return t+=m("RRULE",n),t};var gt=e=>{let t=D(e),n="";return n+=b("VEVENT"),t.forEach(r=>{if(r==="alarms"||r==="attendees")return;let o=Tt[r];if(!o)return;let s=e[r];if(s!=null){if(ie(r)){n+=Z(o,s);return}if(ae(r)){n+=m(o,s.join(","));return}if(r==="recurrenceRule"){n+=ce(s);return}if(r==="duration"){n+=m(o,U(s));return}if(r==="organizer"){n+=ft(s);return}if(r==="sequence"){n+=s.toString();return}n+=m(o,String(s))}}),e.alarms&&e.alarms.length>0&&e.alarms.forEach(r=>{n+=ut(r)}),e.attendees&&e.attendees.length>0&&e.attendees.forEach(r=>{n+=se(r,"ATTENDEE")}),n+=O("VEVENT"),n};var Rt={"LAST-MODIFIED":"lastModified",TZID:"id",TZURL:"url"},dt={id:"TZID",lastModified:"LAST-MODIFIED",url:"TZURL"};var bt={COMMENT:"comment",DTSTART:"start",RDATE:"recurrenceDate",RRULE:"recurrenceRule",TZNAME:"name",TZOFFSETFROM:"offsetFrom",TZOFFSETTO:"offsetTo"},Ot={comment:"COMMENT",name:"TZNAME",offsetFrom:"TZOFFSETFROM",offsetTo:"TZOFFSETTO",recurrenceDate:"RDATE",recurrenceRule:"RRULE",start:"DTSTART"};var Dt=e=>{let t=D(e),n="";return n+=b(e.type),t.forEach(r=>{if(r==="type")return;let o=Ot[r];if(!o)return;let s=e[r];if(r==="start"){n+=m(o,W(s));return}if(r==="recurrenceRule"){n+=ce(s);return}if(r==="recurrenceDate"){n+=Z(o,s);return}n+=m(o,String(s))}),n+=O(e.type),n};var At=e=>{let t=D(e),n="";return n+=b("VTIMEZONE"),t.forEach(r=>{if(r==="props")return;let o=dt[r];if(!o)return;let s=e[r];if(r==="lastModified"){n+=m(o,W(s));return}n+=m(o,String(s))}),e.props&&e.props.length>0&&e.props.forEach(r=>{n+=Dt(r)}),n+=O("VTIMEZONE"),n};var xt=e=>{let t=e.split(re),n=[];return t.forEach(r=>{if(r.length<75){n.push(r);return}tr(r,75).forEach(o=>{n.push(o)})}),n.join(ne)},tr=(e,t)=>{let n=e,r=[];for(;Math.ceil(n.length/t)>=1;)r.push(r.length===0?n.substring(0,t):` ${n.substring(0,t)}`),n=n.substring(t);return r};var xs=e=>{let t=D(e),n="";return n+=b("VCALENDAR"),t.forEach(r=>{if(r==="events"||r==="timezones")return;let o=Je[r];if(!o)return;let s=e[r];n+=m(o,s)}),e.timezones&&e.timezones.length>0&&e.timezones.forEach(r=>{n+=At(r)}),e.events&&e.events.length>0&&e.events.forEach(r=>{n+=gt(r)}),n+=O("VCALENDAR"),xt(n)};import q from"lodash/set";import{z as v}from"zod";import{z as E}from"zod";var rr=["BASE64"],Ws=["BINARY"],pe=E.discriminatedUnion("type",[E.object({type:E.literal("uri"),url:E.string().url(),formatType:E.string().optional(),encoding:E.never().optional(),value:E.never().optional(),binary:E.never().optional()}),E.object({type:E.literal("binary"),url:E.never().optional(),formatType:E.never().optional(),encoding:E.enum(rr),value:E.enum(["BINARY"]),binary:E.string()})]);import{z as I}from"zod";var nr=["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED"],H=I.object({email:I.string().email(),name:I.string().optional(),member:I.string().email().optional(),delegatedFrom:I.string().email().optional(),role:I.string().optional(),partstat:I.enum(nr).optional(),dir:I.string().url().optional(),sentBy:I.string().email().optional()});import{z as L}from"zod";var z=L.object({before:L.boolean().optional(),weeks:L.number().optional(),days:L.number().optional(),hours:L.number().optional(),minutes:L.number().optional(),seconds:L.number().optional()});import{z as V}from"zod";import{setMilliseconds as or}from"date-fns";import{z as j}from"zod";var sr=["DATE","DATE-TIME"],ir=j.object({date:j.date(),timezone:j.string(),tzoffset:j.string()}),l=j.object({date:j.date().transform(e=>or(e,0)),type:j.enum(sr).optional(),local:ir.optional()});var ar=["START","END"],cr=V.discriminatedUnion("type",[V.object({type:V.literal("absolute"),value:l}),V.object({type:V.literal("relative"),value:z})]),pr=V.object({related:V.enum(ar).optional()}),mr=V.object({options:pr.optional()}),me=V.intersection(mr,cr);var ue=v.object({action:v.string().default("DISPLAY"),description:v.string().optional(),trigger:me,attendees:v.array(H).optional(),duration:z.optional(),repeat:v.number().optional(),summary:v.string().optional(),attachments:v.array(pe).optional()});import{z as M}from"zod";import{z as y}from"zod";import{z as X}from"zod";var ye=X.object({name:X.string().optional(),email:X.string().email(),dir:X.string().optional(),sentBy:X.string().email().optional()});import{z as f}from"zod";import{z as Ye}from"zod";var C=["SU","MO","TU","WE","TH","FR","SA"],Te=Ye.object({day:Ye.enum(C),occurence:Ye.number().optional()});var ur=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"],w=f.object({frequency:f.enum(ur),until:l.optional(),count:f.number().optional(),interval:f.number().optional(),bySecond:f.array(f.number().min(0).max(60)).optional(),byMinute:f.array(f.number().min(0).max(59)).optional(),byHour:f.array(f.number().min(0).max(23)).optional(),byDay:f.array(Te).optional(),byMonthday:f.array(f.number().min(-31).max(31)).optional(),byYearday:f.array(f.number().min(1).max(366)).optional(),byWeekNo:f.array(f.number().min(1).max(53)).optional(),byMonth:f.array(f.number().min(0).max(11)).optional(),bySetPos:f.array(f.number().min(-366).max(366)).optional(),workweekStart:f.enum(C).optional()});import{z as It}from"zod";var fe=It.object({range:It.literal("THISANDFUTURE").optional(),value:l});var Vt=["TENTATIVE","CONFIRMED","CANCELLED"];var yr=["TRANSPARENT","OPAQUE"],Tr=["PRIVATE","PUBLIC","CONFIDENTIAL"],fr=y.union([y.object({duration:z,end:y.never().optional()}),y.object({duration:y.never().optional(),end:l})]),lr=y.object({summary:y.string(),uid:y.string(),created:l.optional(),lastModified:l.optional(),stamp:l,start:l,location:y.string().optional(),description:y.string().optional(),categories:y.array(y.string()).optional(),recurrenceRule:w.optional(),alarms:y.array(ue).optional(),timeTransparent:y.enum(yr).optional(),url:y.string().url().optional(),geo:y.string().optional(),class:y.enum(Tr).optional(),organizer:ye.optional(),priority:y.string().optional(),sequence:y.number().optional(),status:y.enum(Vt).optional(),attach:y.string().optional(),recurrenceId:fe.optional(),attendees:y.array(H).optional(),comment:y.string().optional()}),le=y.intersection(lr,fr);import{z as R}from"zod";var Er=["STANDARD","DAYLIGHT"],Le=R.object({type:R.enum(Er),start:R.date(),offsetTo:R.string(),offsetFrom:R.string(),recurrenceRule:w.optional(),comment:R.string().optional(),recurrenceDate:l.optional(),name:R.string().optional()}),Ee=R.object({id:R.string(),lastModified:R.date().optional(),url:R.string().url().optional(),props:R.array(Le)});var gr=["PUBLISH"],St=M.object({version:M.literal("2.0"),prodId:M.string(),method:M.union([M.enum(gr),M.string()]).optional(),timezones:M.array(Ee).optional(),events:M.array(le).optional()});var je=(e,t)=>(t==null?void 0:t.VALUE)==="BINARY"?{type:"binary",encoding:(t==null?void 0:t.ENCODING)||"BASE64",binary:e,value:t==null?void 0:t.VALUE}:{type:"uri",url:e,formatType:t==null?void 0:t.FMTTYPE},ra=(e,t)=>pe.parse(je(e,t));var K=e=>e.replace(/mailto:/gi,"");var ee=(e,t)=>({email:K(e),delegatedFrom:t!=null&&t["DELEGATED-FROM"]?K(t["DELEGATED-FROM"]):void 0,dir:t==null?void 0:t.DIR,member:t!=null&&t.MEMBER?K(t.MEMBER):void 0,name:t==null?void 0:t.CN,partstat:t==null?void 0:t.PARTSTAT,role:t==null?void 0:t.ROLE,sentBy:t!=null&&t["SENT-BY"]?K(t["SENT-BY"]):void 0}),pa=(e,t)=>H.parse(ee(e,t));import F from"lodash/set";var P=e=>{let t=e,n={};t[0]==="-"&&(F(n,"before",!0),t=t.slice(1)),t=t.slice(1);let r=t.split("T"),o=r[0];if(o.includes("D")){let[i,a]=o.split("D");F(n,"days",Number(i)),o=a}if(o.includes("W")){let[i,a]=o.split("W");F(n,"weeks",Number(i)),o=a}let s=r[1];if(s){if(s.includes("H")){let[i,a]=s.split("H");F(n,"hours",Number(i)),s=a}if(s.includes("M")){let[i,a]=s.split("M");F(n,"minutes",Number(i)),s=a}if(s.includes("S")){let[i,a]=s.split("S");F(n,"seconds",Number(i)),s=a}}return n},fa=e=>z.parse(P(e));import{addMilliseconds as nn}from"date-fns";import{z as Nt}from"zod";var ve=e=>{let t=parseInt(e.slice(0,4),10),n=parseInt(e.slice(4,6),10)-1,r=parseInt(e.slice(6,8),10);return new Date(t,n,r)},ga=e=>Nt.date().parse(ve(e)),B=e=>{let t=parseInt(e.slice(0,4),10),n=parseInt(e.slice(4,6),10)-1,r=parseInt(e.slice(6,8),10),o=parseInt(e.slice(9,11),10),s=parseInt(e.slice(11,13),10),i=parseInt(e.slice(13,15),10);return new Date(Date.UTC(t,n,r,o,s,i))},Ra=(e,t)=>Nt.date().parse(B(e,t));import{compareAsc as Xr,millisecondsToHours as en,millisecondsToMinutes as tn}from"date-fns";import{getTimezoneOffset as rn}from"date-fns-tz";import{addYears as Gr}from"date-fns";import{addDays as Rr,addHours as dr,addMinutes as br,addMonths as Or,addSeconds as Dr,addWeeks as Ar,addYears as xr}from"date-fns";var $=(e,t)=>t===void 0?!1:e>=t,zt=(e,{start:t,end:n},r)=>{if($(r.length,e.count))return;let o=e.frequency,s=e.interval||1;if(!o)return;let i=t;if(o==="SECONDLY"){for(;i<n;){if($(r.length,e.count))return;i=Dr(i,s),r.push([i])}return}if(o==="MINUTELY"){for(;i<n;){if($(r.length,e.count))return;i=br(i,s),r.push([i])}return}if(o==="HOURLY"){for(;i<n;){if($(r.length,e.count))return;i=dr(i,s),r.push([i])}return}if(o==="DAILY"){for(;i<n;){if($(r.length,e.count))return;i=Rr(i,s),r.push([i])}return}if(o==="WEEKLY"){for(;i<n;){if($(r.length,e.count))return;i=Ar(i,s),r.push([i])}return}if(o==="MONTHLY"){for(;i<n;)i=Or(i,s),r.push([i]);return}if(o==="YEARLY"){for(;i<n;)i=xr(i,s),r.push([i]);return}};import{compareAsc as qr,isWithinInterval as Jr}from"date-fns";import{addMinutes as Ir,addWeeks as Vr,eachDayOfInterval as Sr,endOfMonth as Mt,endOfYear as Nr,getDay as ge,isWithinInterval as zr,setDay as Re,startOfDay as Mr,startOfMonth as Kt,startOfYear as Kr,subWeeks as hr}from"date-fns";var ht=(e,t,n,r)=>{let o=n.map(({day:s,occurence:i})=>({occurence:i,day:C.indexOf(s)}));return e.frequency==="YEARLY"?e.byYearday||e.byMonthday?t.map(s=>s.filter(i=>o.find(({day:a})=>a===ge(i)))):e.byWeekNo?t.map(s=>s.map(i=>o.map(({day:a})=>Re(i,a,{weekStartsOn:r}))).flat()):e.byMonth?t.map(s=>s.map(i=>o.map(({day:a,occurence:c})=>Ce(h(Kt(i)),h(Mt(i)),a,r,c)).flat()).flat()):t.map(s=>s.map(i=>o.map(({day:a,occurence:c})=>Ce(h(Kr(i)),h(Nr(i)),a,r,c)).flat()).flat()):e.frequency==="MONTHLY"?e.byMonthday?t.map(s=>s.filter(i=>o.find(({day:a})=>a===ge(i)))):t.map(s=>s.map(i=>o.map(({day:a,occurence:c})=>Ce(h(Kt(i)),h(Mt(i)),a,r,c)).flat()).flat()):e.frequency==="WEEKLY"?t.map(s=>s.map(i=>o.map(({day:a})=>Re(i,a,{weekStartsOn:r}))).flat()):t.map(s=>s.filter(i=>o.find(({day:a})=>a===ge(i))))},Ce=(e,t,n,r,o)=>{if(o!==void 0){if(!(o<0)){let T=Re(e,n,{weekStartsOn:r}),u=e>T;return Vr(T,(o||1)-1+(u?1:0))}let a=Re(t,n,{weekStartsOn:r}),c=t<a;return h(Mr(hr(a,-(o||1)-1+(c?1:0))))}return Sr({start:e,end:t}).map(i=>h(i)).filter(i=>zr(i,{start:e,end:t})).filter(i=>n===ge(i))},h=e=>Ir(e,-e.getTimezoneOffset());import{getHours as Yr,setHours as Lr}from"date-fns";var Yt=(e,t,n)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"?t.map(r=>r.map(o=>n.map(s=>Lr(o,s))).flat()):t.map(r=>r.filter(o=>n.includes(Yr(o))));import{getMinutes as jr,setMinutes as vr}from"date-fns";var Lt=(e,t,n)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"||e.frequency==="HOURLY"?t.map(r=>r.map(o=>n.map(s=>vr(o,s))).flat()):t.map(r=>r.filter(o=>n.includes(jr(o))));import{getMonth as Cr,setMonth as Pr}from"date-fns";var jt=(e,t,n)=>e.frequency==="YEARLY"?t.map(r=>r.map(o=>n.map(s=>Pr(o,s))).flat()):t.map(r=>r.filter(o=>n.includes(Cr(o))));import{getDaysInMonth as Br,getMonth as _r,setDate as kr}from"date-fns";import Ur from"lodash/compact";var vt=(e,t,n)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"?t.map(r=>r.map(o=>{let s=Br(o);return Ur(n.map(i=>i>s?void 0:kr(o,i)))}).flat()):e.frequency==="WEEKLY"?t:t.map(r=>r.filter(o=>n.includes(_r(o))));import{getSeconds as Wr,setSeconds as Zr}from"date-fns";var Ct=(e,t,n)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"||e.frequency==="HOURLY"||e.frequency==="MINUTELY"?t.map(r=>r.map(o=>n.map(s=>Zr(o,s))).flat()):t.map(r=>r.filter(o=>n.includes(Wr(o))));import{compareAsc as Hr}from"date-fns";var Pt=(e,t,n)=>!e.byYearday&&!e.byWeekNo&&!e.byMonthday&&!e.byMonth&&!e.byDay&&!e.byHour&&!e.byMinute&&!e.bySecond?t:t.map(r=>r.sort(Hr).filter((o,s)=>n.some(i=>i>0?s===0?!1:s%i===0:s===0?r.length-1+i===0:s%(r.length-1+i)===0)));import{setWeek as wr}from"date-fns";var Bt=(e,t,n,r)=>e.frequency==="YEARLY"?t.map(o=>o.map(s=>n.map(i=>wr(s,i,{weekStartsOn:r}))).flat()):t;import{getYear as Fr,setDayOfYear as $r}from"date-fns";var _t=(e,t,n)=>e.frequency==="YEARLY"?t.map(r=>r.map(o=>n.map(s=>$r(o,s))).flat()):e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"?t:t.map(r=>r.filter(o=>n.includes(Fr(o))));var kt=(e,t,n)=>{let r=n;return e.byMonth&&(r=jt(e,r,e.byMonth)),e.byWeekNo&&(r=Bt(e,r,e.byWeekNo,t.weekStartsOn)),e.byYearday&&(r=_t(e,r,e.byYearday)),e.byMonthday&&(r=vt(e,r,e.byMonthday)),e.byDay&&(r=ht(e,r,e.byDay,t.weekStartsOn)),e.byHour&&(r=Yt(e,r,e.byHour)),e.byMinute&&(r=Lt(e,r,e.byMinute)),e.bySecond&&(r=Ct(e,r,e.bySecond)),e.bySetPos&&(r=Pt(e,r,e.bySetPos)),r.map(s=>s.sort(qr).filter(i=>Jr(i,{start:t.start,end:t.end})))};var Qr=2,Ut=(e,t)=>{var c;let n=t.start,r=((c=e.until)==null?void 0:c.date)||(t==null?void 0:t.end)||Gr(n,Qr),o=(e.workweekStart?C.indexOf(e.workweekStart):1)%7,s=[[n]];zt(e,{start:n,end:r},s);let i=kt(e,{start:n,end:r,weekStartsOn:o},s);return e.count?i.flat().splice(0,e.count):i.flat()};var Wt=(e,t)=>t.map(n=>!n.recurrenceRule||n.recurrenceRule.until&&n.recurrenceRule.until.date<e?n:Ut(n.recurrenceRule,{start:n.start,end:e}).map(o=>({...n,start:o}))).flat();var Pe=e=>{let t=e[0]==="+"?1:-1,n=Number(e.slice(1,3)),r=e.length>3?Number(e.slice(3,5)):0,o=e.length>5?Number(e.slice(5,7)):0;return((n*60+r)*60+o)*1e3*t};var Zt=(e,t,n)=>{let r=n==null?void 0:n.find(s=>s.id===t);if(r){let s=Wt(e,r.props).sort((c,p)=>Xr(c.start,p.start));for(let c=0;c<s.length;c+=1)if(e<s[c].start){let p=s[c-1]?s[c-1].offsetTo:s[c].offsetFrom,T=p.length>5?p.substring(0,5):p;return{offset:T,milliseconds:Pe(T)}}let i=s[s.length-1].offsetTo,a=i.length>5?i.substring(0,5):i;return{offset:a,milliseconds:Pe(a)}}let o=rn(t,e);if(!Number.isNaN(o)){let s=o<0,i=Math.abs(en(o)),a=Math.abs(tn(o))-i*60,c=i.toString().length===1?`0${i}`:i.toString(),p=a.toString().length===1?`0${a}`:a.toString();return{offset:`${s?"-":"+"}${c}${p}`,milliseconds:o}}};var d=(e,t,n)=>{if((t==null?void 0:t.VALUE)==="DATE")return{date:ve(e),type:t==null?void 0:t.VALUE};let r=(t==null?void 0:t.VALUE)||"DATE-TIME",o=B(e);if(!(t!=null&&t.TZID))return{date:o,type:r};let s=Zt(o,t.TZID,n);return s?{date:nn(o,-s.milliseconds),type:r,local:t!=null&&t.TZID?{date:o,timezone:t==null?void 0:t.TZID,tzoffset:s.offset}:void 0}:{date:o,type:r}},gc=(e,t,n)=>l.parse(d(e,t,n));var Be=(e,t,n)=>(t==null?void 0:t.VALUE)==="DATE-TIME"||(t==null?void 0:t.VALUE)==="DATE"?{type:"absolute",value:d(e,t,n),options:{related:t==null?void 0:t.RELATED}}:{type:"relative",value:P(e),options:{related:t==null?void 0:t.RELATED}},Ac=(e,t,n)=>me.parse(Be(e,t,n));import on from"lodash/set";var sn=e=>e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e,_e=e=>e.map(t=>{let[n,...r]=t.split(Q),o=r.join(Q);return{property:n,value:sn(o)}},{}),an=e=>e.reduce((t,n)=>(on(t,n.property,n.value),t),{}),Ht=e=>an(_e(e));var cn=e=>{let t=!1,n;for(let s=0;s<e.length&&n===void 0;s+=1)e.charAt(s)===st&&(t=!t),e.charAt(s)===ot&&!t&&(n=s);if(n===void 0)throw Error(`Line not valid: ${e}`);let r=e.substring(0,n),o=e.substring(n+1);return{property:r,value:o}},A=e=>{let{property:t,value:n}=cn(e);if(t.includes(Y)){let[r,...o]=t.split(Y),s=Ht(o);return{property:r,options:s,value:n}}return{property:t,value:n}};var x=e=>{let t=[],n=e.split(re).filter(r=>r!=="");for(let r=0;r<n.length;){let o=n[r];for(r+=1;n[r]&&/^[ \t]/.test(n[r]);)o+=n[r].trimStart(),r+=1;t.push(o)}return t};var ke=(e,t)=>{let n=e.replace(nt,""),r=x(n),o={},s=[],i=[];return r.forEach(a=>{let{property:c,options:p,value:T}=A(a),u=Fe[c];if(u){if(u==="trigger"){q(o,u,Be(T,p,t));return}if(u==="duration"){q(o,u,P(T));return}if(u==="repeat"){q(o,u,Number(T));return}if(u==="attachment"){s.push(je(T,p));return}if(u==="attendee"){i.push(ee(T,p));return}q(o,u,T)}}),s.length>0&&q(o,"attachments",s),i.length>0&&q(o,"attendees",i),o},wc=(e,t)=>ue.parse(ke(e,t));import we from"lodash/set";import S from"lodash/set";var Ue=(e,t)=>({name:t==null?void 0:t.CN,dir:t==null?void 0:t.DIR,sentBy:t!=null&&t["SENT-BY"]?K(t["SENT-BY"]):void 0,email:K(e)}),Jc=(e,t)=>ye.parse(Ue(e,t));import J from"lodash/set";var wt={BYDAY:"byDay",BYHOUR:"byHour",BYMINUTE:"byMinute",BYMONTH:"byMonth",BYMONTHDAY:"byMonthday",BYSECOND:"bySecond",BYSETPOS:"bySetPos",BYWEEKNO:"byWeekNo",BYYEARDAY:"byYearday",COUNT:"count",FREQ:"frequency",INTERVAL:"interval",UNTIL:"until",WKST:"workweekStart"};var We=e=>{if(e.length===2)return{day:e};let n=e.slice(0,-2);return{day:e.replace(n,""),occurence:Number(n)}},ep=e=>Te.parse(We(e));var pn=["until"],mn=e=>pn.includes(e),un=["bySecond","byMinute","byHour","byMonthday","byYearday","byWeekNo","bySetPos"],yn=e=>un.includes(e),Tn=["byDay"],fn=e=>Tn.includes(e),ln=["count","interval"],En=e=>ln.includes(e),te=(e,t)=>{let n={};return _e(e.split(Y)).forEach(o=>{let{property:s,value:i}=o,a=wt[s];if(a){if(mn(a)){J(n,a,d(i,{},t));return}if(yn(a)){J(n,a,i.split(k).map(c=>Number(c)));return}if(a==="byMonth"){J(n,a,i.split(k).map(c=>Number(c)-1));return}if(fn(a)){J(n,a,i.split(k).map(c=>We(c)));return}if(En(a)){J(n,a,Number(i));return}J(n,a,i)}}),n},up=(e,t)=>w.parse(te(e,t));var Ze=(e,t)=>{let n=e.replace(rt,""),r=x(n.replace(he,"")),o={},s=[];r.forEach(a=>{let{property:c,options:p,value:T}=A(a),u=yt[c];if(u){if(ie(u)){S(o,u,d(T,p,t));return}if(ae(u)){S(o,u,T.split(k));return}if(u==="recurrenceRule"){S(o,u,te(T,t));return}if(u==="duration"){S(o,u,P(T));return}if(u==="organizer"){S(o,u,Ue(T,p));return}if(u==="sequence"){S(o,u,Number(T));return}if(u==="attendee"){s.push(ee(T,p));return}S(o,u,T)}});let i=[...e.matchAll(he)].map(a=>a[0]);if(i.length>0){let a=i.map(c=>ke(c,t));S(o,"alarms",a)}return s.length>0&&S(o,"attendees",s),o},zp=(e,t)=>le.parse(Ze(e,t));import Ft from"lodash/set";import de from"lodash/set";var be=(e,t)=>{let n=e.replace(et,"").replace(tt,""),r=x(n),o={type:t||"STANDARD"};return r.forEach(s=>{let{property:i,options:a,value:c}=A(s),p=bt[i];if(p){if(p==="start"){de(o,p,B(c));return}if(p==="recurrenceRule"){de(o,p,te(c));return}if(p==="recurrenceDate"){de(o,p,d(c,a));return}de(o,p,c)}}),o},Up=(e,t)=>Le.parse(be(e,t));var He=e=>{let t=e.replace(Xe,""),n=x(t.replace(ze,"").replace(Me,"")),r={props:[]};n.forEach(i=>{let{property:a,value:c}=A(i),p=Rt[a];if(p){if(p==="lastModified"){Ft(r,p,B(c));return}Ft(r,p,c)}});let o=[...t.matchAll(ze)].map(i=>i[0]);o.length>0&&o.forEach(i=>{r.props.push(be(i,"STANDARD"))});let s=[...t.matchAll(Me)].map(i=>i[0]);return s.length>0&&s.forEach(i=>{r.props.push(be(i,"DAYLIGHT"))}),r},em=e=>Ee.parse(He(e));var gn=e=>{let t=e.replace(Qe,""),n=x(t.replace(Ke,"").replace(Ne,"")),r={};n.forEach(i=>{let{property:a,value:c}=A(i),p=qe[a];p&&we(r,p,c)});let o=[...t.matchAll(Ne)].map(i=>i[0]);if(o.length>0){let i=o.map(a=>He(a));we(r,"timezones",i)}let s=[...t.matchAll(Ke)].map(i=>i[0]);if(s.length>0){let i=s.map(a=>Ze(a,r.timezones));we(r,"events",i)}return r},um=e=>St.parse(gn(e));var Rn=(e,t,n)=>({value:d(e,t,n),range:t==null?void 0:t.RANGE}),Em=(e,t,n)=>fe.parse(Rn(e,t,n));import{addDays as dn,addHours as bn,addMinutes as On,addSeconds as Dn,addWeeks as An,differenceInDays as xn,differenceInHours as In,differenceInMinutes as Vn,differenceInSeconds as Sn,differenceInWeeks as Nn,subDays as zn,subHours as Mn,subMinutes as Kn,subSeconds as hn,subWeeks as Yn}from"date-fns";var $t=(e,t)=>t.before?Yn(zn(Mn(Kn(hn(e,t.seconds||0),t.minutes||0),t.hours||0),t.days||0),t.weeks||0):An(dn(bn(On(Dn(e,t.seconds||0),t.minutes||0),t.hours||0),t.days||0),t.weeks||0),Pm=(e,t)=>{let n=Math.abs(Nn(t,e)),r=Math.abs(xn(t,e)),o=r-n*7,s=Math.abs(In(t,e)),i=s-r*24,a=Math.abs(Vn(t,e)),c=a-s*60,T=Math.abs(Sn(t,e))-a*60;return{before:e>t,weeks:n,days:o,hours:i,minutes:c,seconds:T}};var km=e=>e.end?e.end.date:$t(e.start.date,e.duration);export{Qr as DEFAULT_END_IN_YEARS,nr as attendeePartStatusTypes,Tr as classTypes,sr as dateObjectTypes,rr as encodingTypes,Ut as extendByRecurrenceRule,Wt as extendTimezoneProps,ut as generateIcsAlarm,at as generateIcsAttachment,se as generateIcsAttendee,xs as generateIcsCalendar,pt as generateIcsDate,W as generateIcsDateTime,U as generateIcsDuration,gt as generateIcsEvent,N as generateIcsMail,ft as generateIcsOrganizer,ce as generateIcsRecurrenceRule,Z as generateIcsTimeStamp,At as generateIcsTimezone,Dt as generateIcsTimezoneProp,mt as generateIcsTrigger,lt as generateIcsWeekdayNumber,Pm as getDurationFromInterval,km as getEventEnd,$t as getEventEndFromDuration,Zt as getTimezoneObjectOffset,ke as icsAlarmToObject,je as icsAttachmentToObject,ee as icsAttendeeToObject,gn as icsCalendarToObject,B as icsDateTimeToDateTime,ve as icsDateToDate,P as icsDurationToObject,Ze as icsEventToObject,Ue as icsOrganizerToObject,Rn as icsRecurrenceIdToObject,te as icsRecurrenceRuleToObject,d as icsTimeStampToObject,be as icsTimezonePropToObject,He as icsTimezoneToObject,Be as icsTriggerToObject,We as icsWeekdayNumberToObject,wc as parseIcsAlarm,ra as parseIcsAttachment,pa as parseIcsAttendee,um as parseIcsCalendar,ga as parseIcsDate,Ra as parseIcsDateTime,fa as parseIcsDuration,zp as parseIcsEvent,Jc as parseIcsOrganizer,Em as parseIcsRecurrenceId,up as parseIcsRecurrenceRule,em as parseIcsTimezone,Up as parseIcsTimezoneProp,Ac as parseIcsTrigger,ep as parseIcsWeekdayNumber,gc as parseicsTimeStamp,En as recurrenceObjectKeyIsNumber,yn as recurrenceObjectKeyIsNumberArray,mn as recurrenceObjectKeyIsTimeStamp,fn as recurrenceObjectKeyIsWeekdayNumberArray,ur as recurrenceRuleFrequencies,Vt as statusTypes,yr as timeTransparentTypes,Pe as timeZoneOffsetToMilliseconds,Er as timezonePropTypes,ar as triggerRelations,Ws as valueTypes,C as weekDays,pe as zAttachment,H as zAttendee,l as zDateObject,ir as zDateObjectTzProps,ye as zOrganizer,fe as zRecurrenceId,w as zRecurrenceRule,ue as zVAlarm,St as zVCalendar,gr as zVCalendarMethods,le as zVEvent,lr as zVEventBase,z as zVEventDuration,fr as zVEventDurationOrEnd,me as zVEventTrigger,mr as zVEventTriggerBase,pr as zVEventTriggerOptions,cr as zVEventTriggerUnion,Ee as zVTimezone,Le as zVTimezoneProp,Te as zWeekdayNumberObject};
