"use strict";var Br=Object.create;var be=Object.defineProperty;var _r=Object.getOwnPropertyDescriptor;var kr=Object.getOwnPropertyNames;var Ur=Object.getPrototypeOf,Wr=Object.prototype.hasOwnProperty;var Zr=(e,t)=>{for(var r in t)be(e,r,{get:t[r],enumerable:!0})},It=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of kr(t))!Wr.call(e,o)&&o!==r&&be(e,o,{get:()=>t[o],enumerable:!(n=_r(t,o))||n.enumerable});return e};var R=(e,t,r)=>(r=e!=null?Br(Ur(e)):{},It(t||!e||!e.__esModule?be(r,"default",{value:e,enumerable:!0}):r,e)),Hr=e=>It(be({},"__esModule",{value:!0}),e);var An={};Zr(An,{DEFAULT_END_IN_YEARS:()=>Sr,attendeePartStatusTypes:()=>Gt,classTypes:()=>ar,dateObjectTypes:()=>Xt,encodingTypes:()=>Jt,extendByRecurrenceRule:()=>dt,extendTimezoneProps:()=>bt,generateIcsAlarm:()=>at,generateIcsAttachment:()=>nt,generateIcsAttendee:()=>ce,generateIcsCalendar:()=>qr,generateIcsDate:()=>st,generateIcsDateTime:()=>H,generateIcsDuration:()=>Z,generateIcsEvent:()=>ut,generateIcsMail:()=>h,generateIcsOrganizer:()=>ct,generateIcsRecurrenceRule:()=>pe,generateIcsTimeStamp:()=>w,generateIcsTimezone:()=>Tt,generateIcsTimezoneProp:()=>yt,generateIcsTrigger:()=>it,generateIcsWeekdayNumber:()=>pt,getDurationFromInterval:()=>On,getEventEnd:()=>Dn,getEventEndFromDuration:()=>xt,getTimezoneObjectOffset:()=>Ot,icsAlarmToObject:()=>Pe,icsAttachmentToObject:()=>Ne,icsAttendeeToObject:()=>te,icsCalendarToObject:()=>Cr,icsDateTimeToDateTime:()=>k,icsDateToDate:()=>ze,icsDurationToObject:()=>_,icsEventToObject:()=>ke,icsOrganizerToObject:()=>Be,icsRecurrenceIdToObject:()=>Pr,icsRecurrenceRuleToObject:()=>se,icsTimeStampToObject:()=>A,icsTimezonePropToObject:()=>de,icsTimezoneToObject:()=>Ue,icsTriggerToObject:()=>Ce,icsWeekdayNumberToObject:()=>_e,parseIcsAlarm:()=>cn,parseIcsAttachment:()=>Gr,parseIcsAttendee:()=>Qr,parseIcsCalendar:()=>dn,parseIcsDate:()=>en,parseIcsDateTime:()=>tn,parseIcsDuration:()=>Xr,parseIcsEvent:()=>En,parseIcsOrganizer:()=>pn,parseIcsRecurrenceId:()=>bn,parseIcsRecurrenceRule:()=>ln,parseIcsTimezone:()=>Rn,parseIcsTimezoneProp:()=>gn,parseIcsTrigger:()=>nn,parseIcsWeekdayNumber:()=>mn,parseicsTimeStamp:()=>rn,recurrenceObjectKeyIsNumber:()=>vr,recurrenceObjectKeyIsNumberArray:()=>Lr,recurrenceObjectKeyIsTimeStamp:()=>Yr,recurrenceObjectKeyIsWeekdayNumberArray:()=>jr,recurrenceRuleFrequencies:()=>sr,statusTypes:()=>lt,timeTransparentTypes:()=>ir,timeZoneOffsetToMilliseconds:()=>ve,timezonePropTypes:()=>mr,triggerRelations:()=>tr,valueTypes:()=>Jr,weekDays:()=>P,zAttachment:()=>me,zAttendee:()=>F,zDateObject:()=>g,zDateObjectTzProps:()=>er,zOrganizer:()=>Te,zRecurrenceId:()=>le,zRecurrenceRule:()=>$,zVAlarm:()=>ye,zVCalendar:()=>Et,zVCalendarMethods:()=>ur,zVEvent:()=>Ee,zVEventBase:()=>pr,zVEventDuration:()=>Y,zVEventDurationOrEnd:()=>cr,zVEventTrigger:()=>ue,zVEventTriggerBase:()=>or,zVEventTriggerOptions:()=>nr,zVEventTriggerUnion:()=>rr,zVTimezone:()=>ge,zVTimezoneProp:()=>Se,zWeekdayNumberObject:()=>fe});module.exports=Hr(An);var Vt={ACTION:"action",DESCRIPTION:"description",DURATION:"duration",REPEAT:"repeat",SUMMARY:"summary",TRIGGER:"trigger",ATTACH:"attachment",ATTENDEE:"attendee"},St={action:"ACTION",description:"DESCRIPTION",duration:"DURATION",repeat:"REPEAT",summary:"SUMMARY",trigger:"TRIGGER",attachment:"ATTACH",attendee:"ATTENDEE"};var rt=R(require("lodash/compact"),1);var Nt={METHOD:"method",PRODID:"prodId",VERSION:"version"},zt={method:"METHOD",prodId:"PRODID",version:"VERSION"};var Ze="BEGIN",He="END",Mt="VCALENDAR",we="VTIMEZONE",Fe="STANDARD",$e="DAYLIGHT",qe="VEVENT",Je="VALARM";var ie=e=>new RegExp(`${Ze}:${e}([\\s\\S]*?)${He}:${e}`,"g"),Ge=ie(we),Qe=ie(Fe),Xe=ie($e),et=ie(qe),tt=ie(Je),Q=e=>new RegExp(`${Ze}:${e}|${He}:${e}`,"g"),Kt=Q(Mt),ht=Q(we),Yt=Q(Fe),Lt=Q($e),jt=Q(qe),vt=Q(Je);var Oe=/\r\n|\r|\n/,De=`\r
`,Ct=":",X=",",Pt='"',W=";";var ae="=";var Ae=e=>`${e}${De}`,y=(e,t,r)=>r?t==null?"":Ae(`${e};${r}:${t}`):Ae(`${e}:${t}`),x=e=>Ae(`BEGIN:${e}`),I=e=>Ae(`END:${e}`);var b=e=>{if(!(e.length<1))return`${e.map(t=>`${t.key}${ae}${t.value}`).join(W)}`};var nt=e=>{if(e.type==="uri"){let t=b((0,rt.default)([e.formatType&&{key:"FMTTYPE",value:e.formatType}]));return y("ATTACH",e.url,t)}if(e.type==="binary"){let t=b((0,rt.default)([e.value&&{key:"VALUE",value:e.value},e.encoding&&{key:"ENCODING",value:e.encoding}]));return y("ATTACH",e.binary,t)}throw Error(`Attachment has no type! ${JSON.stringify(e)}`)};var Bt=R(require("lodash/compact"),1);var h=(e,t)=>t?`"MAILTO:${e}"`:`MAILTO:${e}`;var ce=(e,t)=>{let r=b((0,Bt.default)([e.dir&&{key:"DIR",value:`"${e.dir}"`},e.delegatedFrom&&{key:"DELEGATED-FROM",value:h(e.delegatedFrom,!0)},e.member&&{key:"MEMBER",value:h(e.member,!0)},e.role&&{key:"ROLE",value:e.role},e.name&&{key:"CN",value:e.name},e.partstat&&{key:"PARTSTAT",value:e.partstat},e.role&&{key:"ROLE",value:e.role},e.sentBy&&{key:"SENT-BY",value:h(e.sentBy,!0)}]));return y(t,h(e.email),r)};var Z=e=>{let t="";return e.before&&(t+="-"),t+="P",e.weeks&&(t+=`${e.weeks}W`),e.days&&(t+=`${e.days}D`),(e.hours||e.minutes||e.seconds)&&(t+="T",e.hours&&(t+=`${e.hours}H`),e.minutes&&(t+=`${e.minutes}M`),e.seconds&&(t+=`${e.seconds}S`)),t};var kt=R(require("lodash/compact"),1);var _t=R(require("lodash/compact"),1);var ot=R(require("lodash/isDate"),1),st=e=>{if(!(0,ot.default)(e))throw Error(`Incorrect date object: ${e}`);let t=e.toISOString(),r=t.slice(0,4),n=t.slice(5,7),o=t.slice(8,10);return`${r}${n}${o}`},H=e=>{if(!(0,ot.default)(e))throw Error(`Incorrect date object: ${e}`);let t=e.toISOString(),r=t.slice(0,4),n=t.slice(5,7),o=t.slice(8,10),s=t.slice(11,13),i=t.slice(14,16),a=t.slice(17,19);return`${r}${n}${o}T${s}${i}${a}Z`};var w=(e,t)=>{var o;let r=t.type==="DATE"?st(t.date):H(((o=t.local)==null?void 0:o.date)||t.date),n=b((0,_t.default)([t.type&&{key:"VALUE",value:t.type},t.local&&{key:"TZID",value:t.local.timezone}]));return y(e,r,n)};var it=e=>{var r;let t=b((0,kt.default)([((r=e.options)==null?void 0:r.related)&&{key:"RELATED",value:e.options.related}]));if(e.type==="absolute")return w("TRIGGER",e.value);if(e.type==="relative")return y("TRIGGER",Z(e.value),t)};var V=e=>Object.keys(e);var at=e=>{let t=V(e),r="";return r+=x("VALARM"),t.forEach(n=>{if(n==="attachments"||n==="attendees")return;let o=St[n];if(!o)return;let s=e[n];if(s&&s!=null){if(n==="trigger"){r+=it(s);return}if(n==="duration"){r+=y(o,Z(s));return}if(n==="repeat"){r+=y(o,s==null?void 0:s.toString());return}r+=y(o,String(s))}}),e.attachments&&e.attachments.length>0&&e.attachments.forEach(n=>{r+=nt(n)}),e.attendees&&e.attendees.length>0&&e.attendees.forEach(n=>{r+=ce(n,"ATTENDEE")}),r+=I("VALARM"),r};var Ut={"LAST-MODIFIED":"lastModified",ALARM:"alarm",CATEGORIES:"categories",CREATED:"created",DESCRIPTION:"description",DTSTAMP:"stamp",DTSTART:"start",LOCATION:"location",RRULE:"recurrenceRule",SUMMARY:"summary",UID:"uid",TRANSP:"timeTransparent",URL:"url",DTEND:"end",DURATION:"duration",GEO:"geo",CLASS:"class",ORGANIZER:"organizer",PRIORITY:"priority",SEQ:"sequence",STATUS:"status",ATTACH:"attach","RECURRENCE-ID":"recurrenceId",ATTENDEE:"attendee",COMMENT:"comment"},Wt={alarm:"ALARM",categories:"CATEGORIES",created:"CREATED",description:"DESCRIPTION",lastModified:"LAST-MODIFIED",location:"LOCATION",recurrenceRule:"RRULE",stamp:"DTSTAMP",start:"DTSTART",summary:"SUMMARY",uid:"UID",timeTransparent:"TRANSP",url:"URL",end:"DTEND",duration:"DURATION",geo:"GEO",class:"CLASS",organizer:"ORGANIZER",priority:"PRIORITY",sequence:"SEQ",status:"STATUS",attach:"ATTACH",recurrenceId:"RECURRENCE-ID",attendee:"ATTENDEE",comment:"COMMENT"};var wr=["stamp","start","end","created","lastModified"],xe=e=>wr.includes(e),Fr=["categories"],Ie=e=>Fr.includes(e);var Zt=R(require("lodash/compact"),1);var ct=e=>{let t=b((0,Zt.default)([e.dir&&{key:"DIR",value:`"${e.dir}"`},e.name&&{key:"CN",value:e.name},e.sentBy&&{key:"SENT-BY",value:h(e.sentBy)}]));return y("ORGANIZER",h(e.email),t)};var mt=R(require("lodash/compact"),1);var pt=e=>e.occurence?`${e.occurence}${e.day}`:e.day;var pe=e=>{let t="",r=b((0,mt.default)([e.byDay&&{key:"BYDAY",value:e.byDay.map(n=>pt(n)).join(",")},e.byHour&&{key:"BYHOUR",value:e.byHour.join(",")},e.byMinute&&{key:"BYMINUTE",value:e.byMinute.join(",")},e.byMonth&&{key:"BYMONTH",value:e.byMonth.map(n=>n+1).join(",")},e.byMonthday&&{key:"BYMONTHDAY",value:e.byMonthday.join(",")},e.bySecond&&{key:"BYSECOND",value:e.bySecond.join(",")},e.bySetPos&&{key:"BYSETPOS",value:e.bySetPos.join(",")},e.byWeekNo&&{key:"BYWEEKNO",value:e.byWeekNo.join(",")},e.byYearday&&{key:"BYYEARDAY",value:e.byYearday.join(",")},e.count&&{key:"COUNT",value:e.count.toString()},e.frequency&&{key:"FREQ",value:e.frequency},e.interval&&{key:"INTERVAL",value:e.interval.toString()},e.until&&{key:"UNTIL",value:`${e.until.local&&`${b((0,mt.default)([{key:"TZID",value:e.until.local.timezone}]))}=`}${e.until.date}`},e.workweekStart&&{key:"WKST",value:e.workweekStart}]));return t+=y("RRULE",r),t};var ut=e=>{let t=V(e),r="";return r+=x("VEVENT"),t.forEach(n=>{if(n==="alarms"||n==="attendees")return;let o=Wt[n];if(!o)return;let s=e[n];if(s!=null){if(xe(n)){r+=w(o,s);return}if(Ie(n)){r+=y(o,s.join(","));return}if(n==="recurrenceRule"){r+=pe(s);return}if(n==="duration"){r+=y(o,Z(s));return}if(n==="organizer"){r+=ct(s);return}if(n==="sequence"){r+=s.toString();return}r+=y(o,String(s))}}),e.alarms&&e.alarms.length>0&&e.alarms.forEach(n=>{r+=at(n)}),e.attendees&&e.attendees.length>0&&e.attendees.forEach(n=>{r+=ce(n,"ATTENDEE")}),r+=I("VEVENT"),r};var Ht={"LAST-MODIFIED":"lastModified",TZID:"id",TZURL:"url"},wt={id:"TZID",lastModified:"LAST-MODIFIED",url:"TZURL"};var Ft={COMMENT:"comment",DTSTART:"start",RDATE:"recurrenceDate",RRULE:"recurrenceRule",TZNAME:"name",TZOFFSETFROM:"offsetFrom",TZOFFSETTO:"offsetTo"},$t={comment:"COMMENT",name:"TZNAME",offsetFrom:"TZOFFSETFROM",offsetTo:"TZOFFSETTO",recurrenceDate:"RDATE",recurrenceRule:"RRULE",start:"DTSTART"};var yt=e=>{let t=V(e),r="";return r+=x(e.type),t.forEach(n=>{if(n==="type")return;let o=$t[n];if(!o)return;let s=e[n];if(n==="start"){r+=y(o,H(s));return}if(n==="recurrenceRule"){r+=pe(s);return}if(n==="recurrenceDate"){r+=w(o,s);return}r+=y(o,String(s))}),r+=I(e.type),r};var Tt=e=>{let t=V(e),r="";return r+=x("VTIMEZONE"),t.forEach(n=>{if(n==="props")return;let o=wt[n];if(!o)return;let s=e[n];if(n==="lastModified"){r+=y(o,H(s));return}r+=y(o,String(s))}),e.props&&e.props.length>0&&e.props.forEach(n=>{r+=yt(n)}),r+=I("VTIMEZONE"),r};var qt=e=>{let t=e.split(Oe),r=[];return t.forEach(n=>{if(n.length<75){r.push(n);return}$r(n,75).forEach(o=>{r.push(o)})}),r.join(De)},$r=(e,t)=>{let r=e,n=[];for(;Math.ceil(r.length/t)>=1;)n.push(n.length===0?r.substring(0,t):` ${r.substring(0,t)}`),r=r.substring(t);return n};var qr=e=>{let t=V(e),r="";return r+=x("VCALENDAR"),t.forEach(n=>{if(n==="events"||n==="timezones")return;let o=zt[n];if(!o)return;let s=e[n];r+=y(o,s)}),e.timezones&&e.timezones.length>0&&e.timezones.forEach(n=>{r+=Tt(n)}),e.events&&e.events.length>0&&e.events.forEach(n=>{r+=ut(n)}),r+=I("VCALENDAR"),qt(r)};var J=R(require("lodash/set"),1);var C=require("zod");var d=require("zod"),Jt=["BASE64"],Jr=["BINARY"],me=d.z.discriminatedUnion("type",[d.z.object({type:d.z.literal("uri"),url:d.z.string().url(),formatType:d.z.string().optional(),encoding:d.z.never().optional(),value:d.z.never().optional(),binary:d.z.never().optional()}),d.z.object({type:d.z.literal("binary"),url:d.z.never().optional(),formatType:d.z.never().optional(),encoding:d.z.enum(Jt),value:d.z.enum(["BINARY"]),binary:d.z.string()})]);var S=require("zod"),Gt=["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED"],F=S.z.object({email:S.z.string().email(),name:S.z.string().optional(),member:S.z.string().email().optional(),delegatedFrom:S.z.string().email().optional(),role:S.z.string().optional(),partstat:S.z.enum(Gt).optional(),dir:S.z.string().url().optional(),sentBy:S.z.string().email().optional()});var j=require("zod"),Y=j.z.object({before:j.z.boolean().optional(),weeks:j.z.number().optional(),days:j.z.number().optional(),hours:j.z.number().optional(),minutes:j.z.number().optional(),seconds:j.z.number().optional()});var N=require("zod");var Qt=require("date-fns"),v=require("zod"),Xt=["DATE","DATE-TIME"],er=v.z.object({date:v.z.date(),timezone:v.z.string(),tzoffset:v.z.string()}),g=v.z.object({date:v.z.date().transform(e=>(0,Qt.setMilliseconds)(e,0)),type:v.z.enum(Xt).optional(),local:er.optional()});var tr=["START","END"],rr=N.z.discriminatedUnion("type",[N.z.object({type:N.z.literal("absolute"),value:g}),N.z.object({type:N.z.literal("relative"),value:Y})]),nr=N.z.object({related:N.z.enum(tr).optional()}),or=N.z.object({options:nr.optional()}),ue=N.z.intersection(or,rr);var ye=C.z.object({action:C.z.string().default("DISPLAY"),description:C.z.string().optional(),trigger:ue,attendees:C.z.array(F).optional(),duration:Y.optional(),repeat:C.z.number().optional(),summary:C.z.string().optional(),attachments:C.z.array(me).optional()});var L=require("zod");var f=require("zod");var ee=require("zod"),Te=ee.z.object({name:ee.z.string().optional(),email:ee.z.string().email(),dir:ee.z.string().optional(),sentBy:ee.z.string().email().optional()});var E=require("zod");var Ve=require("zod"),P=["SU","MO","TU","WE","TH","FR","SA"],fe=Ve.z.object({day:Ve.z.enum(P),occurence:Ve.z.number().optional()});var sr=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"],$=E.z.object({frequency:E.z.enum(sr),until:g.optional(),count:E.z.number().optional(),interval:E.z.number().optional(),bySecond:E.z.array(E.z.number().min(0).max(60)).optional(),byMinute:E.z.array(E.z.number().min(0).max(59)).optional(),byHour:E.z.array(E.z.number().min(0).max(23)).optional(),byDay:E.z.array(fe).optional(),byMonthday:E.z.array(E.z.number().min(-31).max(31)).optional(),byYearday:E.z.array(E.z.number().min(1).max(366)).optional(),byWeekNo:E.z.array(E.z.number().min(1).max(53)).optional(),byMonth:E.z.array(E.z.number().min(0).max(11)).optional(),bySetPos:E.z.array(E.z.number().min(-366).max(366)).optional(),workweekStart:E.z.enum(P).optional()});var ft=require("zod");var le=ft.z.object({range:ft.z.literal("THISANDFUTURE").optional(),value:g});var lt=["TENTATIVE","CONFIRMED","CANCELLED"];var ir=["TRANSPARENT","OPAQUE"],ar=["PRIVATE","PUBLIC","CONFIDENTIAL"],cr=f.z.union([f.z.object({duration:Y,end:f.z.never().optional()}),f.z.object({duration:f.z.never().optional(),end:g})]),pr=f.z.object({summary:f.z.string(),uid:f.z.string(),created:g.optional(),lastModified:g.optional(),stamp:g,start:g,location:f.z.string().optional(),description:f.z.string().optional(),categories:f.z.array(f.z.string()).optional(),recurrenceRule:$.optional(),alarms:f.z.array(ye).optional(),timeTransparent:f.z.enum(ir).optional(),url:f.z.string().url().optional(),geo:f.z.string().optional(),class:f.z.enum(ar).optional(),organizer:Te.optional(),priority:f.z.string().optional(),sequence:f.z.number().optional(),status:f.z.enum(lt).optional(),attach:f.z.string().optional(),recurrenceId:le.optional(),attendees:f.z.array(F).optional(),comment:f.z.string().optional()}),Ee=f.z.intersection(pr,cr);var D=require("zod");var mr=["STANDARD","DAYLIGHT"],Se=D.z.object({type:D.z.enum(mr),start:D.z.date(),offsetTo:D.z.string(),offsetFrom:D.z.string(),recurrenceRule:$.optional(),comment:D.z.string().optional(),recurrenceDate:g.optional(),name:D.z.string().optional()}),ge=D.z.object({id:D.z.string(),lastModified:D.z.date().optional(),url:D.z.string().url().optional(),props:D.z.array(Se)});var ur=["PUBLISH"],Et=L.z.object({version:L.z.literal("2.0"),prodId:L.z.string(),method:L.z.union([L.z.enum(ur),L.z.string()]).optional(),timezones:L.z.array(ge).optional(),events:L.z.array(Ee).optional()});var Ne=(e,t)=>(t==null?void 0:t.VALUE)==="BINARY"?{type:"binary",encoding:(t==null?void 0:t.ENCODING)||"BASE64",binary:e,value:t==null?void 0:t.VALUE}:{type:"uri",url:e,formatType:t==null?void 0:t.FMTTYPE},Gr=(e,t)=>me.parse(Ne(e,t));var B=e=>e.replace(/mailto:/gi,"");var te=(e,t)=>({email:B(e),delegatedFrom:t!=null&&t["DELEGATED-FROM"]?B(t["DELEGATED-FROM"]):void 0,dir:t==null?void 0:t.DIR,member:t!=null&&t.MEMBER?B(t.MEMBER):void 0,name:t==null?void 0:t.CN,partstat:t==null?void 0:t.PARTSTAT,role:t==null?void 0:t.ROLE,sentBy:t!=null&&t["SENT-BY"]?B(t["SENT-BY"]):void 0}),Qr=(e,t)=>F.parse(te(e,t));var q=R(require("lodash/set"),1);var _=e=>{let t=e,r={};t[0]==="-"&&((0,q.default)(r,"before",!0),t=t.slice(1)),t=t.slice(1);let n=t.split("T"),o=n[0];if(o.includes("D")){let[i,a]=o.split("D");(0,q.default)(r,"days",Number(i)),o=a}if(o.includes("W")){let[i,a]=o.split("W");(0,q.default)(r,"weeks",Number(i)),o=a}let s=n[1];if(s){if(s.includes("H")){let[i,a]=s.split("H");(0,q.default)(r,"hours",Number(i)),s=a}if(s.includes("M")){let[i,a]=s.split("M");(0,q.default)(r,"minutes",Number(i)),s=a}if(s.includes("S")){let[i,a]=s.split("S");(0,q.default)(r,"seconds",Number(i)),s=a}}return r},Xr=e=>Y.parse(_(e));var zr=require("date-fns");var gt=require("zod"),ze=e=>{let t=parseInt(e.slice(0,4),10),r=parseInt(e.slice(4,6),10)-1,n=parseInt(e.slice(6,8),10);return new Date(t,r,n)},en=e=>gt.z.date().parse(ze(e)),k=e=>{let t=parseInt(e.slice(0,4),10),r=parseInt(e.slice(4,6),10)-1,n=parseInt(e.slice(6,8),10),o=parseInt(e.slice(9,11),10),s=parseInt(e.slice(11,13),10),i=parseInt(e.slice(13,15),10);return new Date(Date.UTC(t,r,n,o,s,i))},tn=(e,t)=>gt.z.date().parse(k(e,t));var oe=require("date-fns"),Nr=require("date-fns-tz");var Vr=require("date-fns");var O=require("date-fns"),re=(e,t)=>t===void 0?!1:e>=t,yr=(e,{start:t,end:r},n)=>{if(re(n.length,e.count))return;let o=e.frequency,s=e.interval||1;if(!o)return;let i=t;if(o==="SECONDLY"){for(;i<r;){if(re(n.length,e.count))return;i=(0,O.addSeconds)(i,s),n.push([i])}return}if(o==="MINUTELY"){for(;i<r;){if(re(n.length,e.count))return;i=(0,O.addMinutes)(i,s),n.push([i])}return}if(o==="HOURLY"){for(;i<r;){if(re(n.length,e.count))return;i=(0,O.addHours)(i,s),n.push([i])}return}if(o==="DAILY"){for(;i<r;){if(re(n.length,e.count))return;i=(0,O.addDays)(i,s),n.push([i])}return}if(o==="WEEKLY"){for(;i<r;){if(re(n.length,e.count))return;i=(0,O.addWeeks)(i,s),n.push([i])}return}if(o==="MONTHLY"){for(;i<r;)i=(0,O.addMonths)(i,s),n.push([i]);return}if(o==="YEARLY"){for(;i<r;)i=(0,O.addYears)(i,s),n.push([i]);return}};var je=require("date-fns");var m=require("date-fns");var Tr=(e,t,r,n)=>{let o=r.map(({day:s,occurence:i})=>({occurence:i,day:P.indexOf(s)}));return e.frequency==="YEARLY"?e.byYearday||e.byMonthday?t.map(s=>s.filter(i=>o.find(({day:a})=>a===(0,m.getDay)(i)))):e.byWeekNo?t.map(s=>s.map(i=>o.map(({day:a})=>(0,m.setDay)(i,a,{weekStartsOn:n}))).flat()):e.byMonth?t.map(s=>s.map(i=>o.map(({day:a,occurence:c})=>Rt(U((0,m.startOfMonth)(i)),U((0,m.endOfMonth)(i)),a,n,c)).flat()).flat()):t.map(s=>s.map(i=>o.map(({day:a,occurence:c})=>Rt(U((0,m.startOfYear)(i)),U((0,m.endOfYear)(i)),a,n,c)).flat()).flat()):e.frequency==="MONTHLY"?e.byMonthday?t.map(s=>s.filter(i=>o.find(({day:a})=>a===(0,m.getDay)(i)))):t.map(s=>s.map(i=>o.map(({day:a,occurence:c})=>Rt(U((0,m.startOfMonth)(i)),U((0,m.endOfMonth)(i)),a,n,c)).flat()).flat()):e.frequency==="WEEKLY"?t.map(s=>s.map(i=>o.map(({day:a})=>(0,m.setDay)(i,a,{weekStartsOn:n}))).flat()):t.map(s=>s.filter(i=>o.find(({day:a})=>a===(0,m.getDay)(i))))},Rt=(e,t,r,n,o)=>{if(o!==void 0){if(!(o<0)){let l=(0,m.setDay)(e,r,{weekStartsOn:n}),T=e>l;return(0,m.addWeeks)(l,(o||1)-1+(T?1:0))}let a=(0,m.setDay)(t,r,{weekStartsOn:n}),c=t<a;return U((0,m.startOfDay)((0,m.subWeeks)(a,-(o||1)-1+(c?1:0))))}return(0,m.eachDayOfInterval)({start:e,end:t}).map(i=>U(i)).filter(i=>(0,m.isWithinInterval)(i,{start:e,end:t})).filter(i=>r===(0,m.getDay)(i))},U=e=>(0,m.addMinutes)(e,-e.getTimezoneOffset());var Me=require("date-fns"),fr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"?t.map(n=>n.map(o=>r.map(s=>(0,Me.setHours)(o,s))).flat()):t.map(n=>n.filter(o=>r.includes((0,Me.getHours)(o))));var Ke=require("date-fns"),lr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"||e.frequency==="HOURLY"?t.map(n=>n.map(o=>r.map(s=>(0,Ke.setMinutes)(o,s))).flat()):t.map(n=>n.filter(o=>r.includes((0,Ke.getMinutes)(o))));var he=require("date-fns"),Er=(e,t,r)=>e.frequency==="YEARLY"?t.map(n=>n.map(o=>r.map(s=>(0,he.setMonth)(o,s))).flat()):t.map(n=>n.filter(o=>r.includes((0,he.getMonth)(o))));var ne=require("date-fns"),gr=R(require("lodash/compact"),1),Rr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"?t.map(n=>n.map(o=>{let s=(0,ne.getDaysInMonth)(o);return(0,gr.default)(r.map(i=>i>s?void 0:(0,ne.setDate)(o,i)))}).flat()):e.frequency==="WEEKLY"?t:t.map(n=>n.filter(o=>r.includes((0,ne.getMonth)(o))));var Ye=require("date-fns"),dr=(e,t,r)=>e.frequency==="YEARLY"||e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"||e.frequency==="HOURLY"||e.frequency==="MINUTELY"?t.map(n=>n.map(o=>r.map(s=>(0,Ye.setSeconds)(o,s))).flat()):t.map(n=>n.filter(o=>r.includes((0,Ye.getSeconds)(o))));var br=require("date-fns"),Or=(e,t,r)=>!e.byYearday&&!e.byWeekNo&&!e.byMonthday&&!e.byMonth&&!e.byDay&&!e.byHour&&!e.byMinute&&!e.bySecond?t:t.map(n=>n.sort(br.compareAsc).filter((o,s)=>r.some(i=>i>0?s===0?!1:s%i===0:s===0?n.length-1+i===0:s%(n.length-1+i)===0)));var Dr=require("date-fns"),Ar=(e,t,r,n)=>e.frequency==="YEARLY"?t.map(o=>o.map(s=>r.map(i=>(0,Dr.setWeek)(s,i,{weekStartsOn:n}))).flat()):t;var Le=require("date-fns"),xr=(e,t,r)=>e.frequency==="YEARLY"?t.map(n=>n.map(o=>r.map(s=>(0,Le.setDayOfYear)(o,s))).flat()):e.frequency==="MONTHLY"||e.frequency==="WEEKLY"||e.frequency==="DAILY"?t:t.map(n=>n.filter(o=>r.includes((0,Le.getYear)(o))));var Ir=(e,t,r)=>{let n=r;return e.byMonth&&(n=Er(e,n,e.byMonth)),e.byWeekNo&&(n=Ar(e,n,e.byWeekNo,t.weekStartsOn)),e.byYearday&&(n=xr(e,n,e.byYearday)),e.byMonthday&&(n=Rr(e,n,e.byMonthday)),e.byDay&&(n=Tr(e,n,e.byDay,t.weekStartsOn)),e.byHour&&(n=fr(e,n,e.byHour)),e.byMinute&&(n=lr(e,n,e.byMinute)),e.bySecond&&(n=dr(e,n,e.bySecond)),e.bySetPos&&(n=Or(e,n,e.bySetPos)),n.map(s=>s.sort(je.compareAsc).filter(i=>(0,je.isWithinInterval)(i,{start:t.start,end:t.end})))};var Sr=2,dt=(e,t)=>{var c;let r=t.start,n=((c=e.until)==null?void 0:c.date)||(t==null?void 0:t.end)||(0,Vr.addYears)(r,Sr),o=(e.workweekStart?P.indexOf(e.workweekStart):1)%7,s=[[r]];yr(e,{start:r,end:n},s);let i=Ir(e,{start:r,end:n,weekStartsOn:o},s);return e.count?i.flat().splice(0,e.count):i.flat()};var bt=(e,t)=>t.map(r=>!r.recurrenceRule||r.recurrenceRule.until&&r.recurrenceRule.until.date<e?r:dt(r.recurrenceRule,{start:r.start,end:e}).map(o=>({...r,start:o}))).flat();var ve=e=>{let t=e[0]==="+"?1:-1,r=Number(e.slice(1,3)),n=e.length>3?Number(e.slice(3,5)):0,o=e.length>5?Number(e.slice(5,7)):0;return((r*60+n)*60+o)*1e3*t};var Ot=(e,t,r)=>{let n=r==null?void 0:r.find(s=>s.id===t);if(n){let s=bt(e,n.props).sort((c,p)=>(0,oe.compareAsc)(c.start,p.start));for(let c=0;c<s.length;c+=1)if(e<s[c].start){let p=s[c-1]?s[c-1].offsetTo:s[c].offsetFrom,l=p.length>5?p.substring(0,5):p;return{offset:l,milliseconds:ve(l)}}let i=s[s.length-1].offsetTo,a=i.length>5?i.substring(0,5):i;return{offset:a,milliseconds:ve(a)}}let o=(0,Nr.getTimezoneOffset)(t,e);if(!Number.isNaN(o)){let s=o<0,i=Math.abs((0,oe.millisecondsToHours)(o)),a=Math.abs((0,oe.millisecondsToMinutes)(o))-i*60,c=i.toString().length===1?`0${i}`:i.toString(),p=a.toString().length===1?`0${a}`:a.toString();return{offset:`${s?"-":"+"}${c}${p}`,milliseconds:o}}};var A=(e,t,r)=>{if((t==null?void 0:t.VALUE)==="DATE")return{date:ze(e),type:t==null?void 0:t.VALUE};let n=(t==null?void 0:t.VALUE)||"DATE-TIME",o=k(e);if(!(t!=null&&t.TZID))return{date:o,type:n};let s=Ot(o,t.TZID,r);return s?{date:(0,zr.addMilliseconds)(o,-s.milliseconds),type:n,local:t!=null&&t.TZID?{date:o,timezone:t==null?void 0:t.TZID,tzoffset:s.offset}:void 0}:{date:o,type:n}},rn=(e,t,r)=>g.parse(A(e,t,r));var Ce=(e,t,r)=>(t==null?void 0:t.VALUE)==="DATE-TIME"||(t==null?void 0:t.VALUE)==="DATE"?{type:"absolute",value:A(e,t,r),options:{related:t==null?void 0:t.RELATED}}:{type:"relative",value:_(e),options:{related:t==null?void 0:t.RELATED}},nn=(e,t,r)=>ue.parse(Ce(e,t,r));var Mr=R(require("lodash/set"),1);var on=e=>e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e,Dt=e=>e.map(t=>{let[r,...n]=t.split(ae),o=n.join(ae);return{property:r,value:on(o)}},{}),sn=e=>e.reduce((t,r)=>((0,Mr.default)(t,r.property,r.value),t),{}),Kr=e=>sn(Dt(e));var an=e=>{let t=!1,r;for(let s=0;s<e.length&&r===void 0;s+=1)e.charAt(s)===Pt&&(t=!t),e.charAt(s)===Ct&&!t&&(r=s);if(r===void 0)throw Error(`Line not valid: ${e}`);let n=e.substring(0,r),o=e.substring(r+1);return{property:n,value:o}},z=e=>{let{property:t,value:r}=an(e);if(t.includes(W)){let[n,...o]=t.split(W),s=Kr(o);return{property:n,options:s,value:r}}return{property:t,value:r}};var M=e=>{let t=[],r=e.split(Oe).filter(n=>n!=="");for(let n=0;n<r.length;){let o=r[n];for(n+=1;r[n]&&/^[ \t]/.test(r[n]);)o+=r[n].trimStart(),n+=1;t.push(o)}return t};var Pe=(e,t)=>{let r=e.replace(vt,""),n=M(r),o={},s=[],i=[];return n.forEach(a=>{let{property:c,options:p,value:l}=z(a),T=Vt[c];if(T){if(T==="trigger"){(0,J.default)(o,T,Ce(l,p,t));return}if(T==="duration"){(0,J.default)(o,T,_(l));return}if(T==="repeat"){(0,J.default)(o,T,Number(l));return}if(T==="attachment"){s.push(Ne(l,p));return}if(T==="attendee"){i.push(te(l,p));return}(0,J.default)(o,T,l)}}),s.length>0&&(0,J.default)(o,"attachments",s),i.length>0&&(0,J.default)(o,"attendees",i),o},cn=(e,t)=>ye.parse(Pe(e,t));var We=R(require("lodash/set"),1);var K=R(require("lodash/set"),1);var Be=(e,t)=>({name:t==null?void 0:t.CN,dir:t==null?void 0:t.DIR,sentBy:t!=null&&t["SENT-BY"]?B(t["SENT-BY"]):void 0,email:B(e)}),pn=(e,t)=>Te.parse(Be(e,t));var G=R(require("lodash/set"),1);var hr={BYDAY:"byDay",BYHOUR:"byHour",BYMINUTE:"byMinute",BYMONTH:"byMonth",BYMONTHDAY:"byMonthday",BYSECOND:"bySecond",BYSETPOS:"bySetPos",BYWEEKNO:"byWeekNo",BYYEARDAY:"byYearday",COUNT:"count",FREQ:"frequency",INTERVAL:"interval",UNTIL:"until",WKST:"workweekStart"};var _e=e=>{if(e.length===2)return{day:e};let r=e.slice(0,-2);return{day:e.replace(r,""),occurence:Number(r)}},mn=e=>fe.parse(_e(e));var un=["until"],Yr=e=>un.includes(e),yn=["bySecond","byMinute","byHour","byMonthday","byYearday","byWeekNo","bySetPos"],Lr=e=>yn.includes(e),Tn=["byDay"],jr=e=>Tn.includes(e),fn=["count","interval"],vr=e=>fn.includes(e),se=(e,t)=>{let r={};return Dt(e.split(W)).forEach(o=>{let{property:s,value:i}=o,a=hr[s];if(a){if(Yr(a)){(0,G.default)(r,a,A(i,{},t));return}if(Lr(a)){(0,G.default)(r,a,i.split(X).map(c=>Number(c)));return}if(a==="byMonth"){(0,G.default)(r,a,i.split(X).map(c=>Number(c)-1));return}if(jr(a)){(0,G.default)(r,a,i.split(X).map(c=>_e(c)));return}if(vr(a)){(0,G.default)(r,a,Number(i));return}(0,G.default)(r,a,i)}}),r},ln=(e,t)=>$.parse(se(e,t));var ke=(e,t)=>{let r=e.replace(jt,""),n=M(r.replace(tt,"")),o={},s=[];n.forEach(a=>{let{property:c,options:p,value:l}=z(a),T=Ut[c];if(T){if(xe(T)){(0,K.default)(o,T,A(l,p,t));return}if(Ie(T)){(0,K.default)(o,T,l.split(X));return}if(T==="recurrenceRule"){(0,K.default)(o,T,se(l,t));return}if(T==="duration"){(0,K.default)(o,T,_(l));return}if(T==="organizer"){(0,K.default)(o,T,Be(l,p));return}if(T==="sequence"){(0,K.default)(o,T,Number(l));return}if(T==="attendee"){s.push(te(l,p));return}(0,K.default)(o,T,l)}});let i=[...e.matchAll(tt)].map(a=>a[0]);if(i.length>0){let a=i.map(c=>Pe(c,t));(0,K.default)(o,"alarms",a)}return s.length>0&&(0,K.default)(o,"attendees",s),o},En=(e,t)=>Ee.parse(ke(e,t));var At=R(require("lodash/set"),1);var Re=R(require("lodash/set"),1);var de=(e,t)=>{let r=e.replace(Yt,"").replace(Lt,""),n=M(r),o={type:t||"STANDARD"};return n.forEach(s=>{let{property:i,options:a,value:c}=z(s),p=Ft[i];if(p){if(p==="start"){(0,Re.default)(o,p,k(c));return}if(p==="recurrenceRule"){(0,Re.default)(o,p,se(c));return}if(p==="recurrenceDate"){(0,Re.default)(o,p,A(c,a));return}(0,Re.default)(o,p,c)}}),o},gn=(e,t)=>Se.parse(de(e,t));var Ue=e=>{let t=e.replace(ht,""),r=M(t.replace(Qe,"").replace(Xe,"")),n={props:[]};r.forEach(i=>{let{property:a,value:c}=z(i),p=Ht[a];if(p){if(p==="lastModified"){(0,At.default)(n,p,k(c));return}(0,At.default)(n,p,c)}});let o=[...t.matchAll(Qe)].map(i=>i[0]);o.length>0&&o.forEach(i=>{n.props.push(de(i,"STANDARD"))});let s=[...t.matchAll(Xe)].map(i=>i[0]);return s.length>0&&s.forEach(i=>{n.props.push(de(i,"DAYLIGHT"))}),n},Rn=e=>ge.parse(Ue(e));var Cr=e=>{let t=e.replace(Kt,""),r=M(t.replace(et,"").replace(Ge,"")),n={};r.forEach(i=>{let{property:a,value:c}=z(i),p=Nt[a];p&&(0,We.default)(n,p,c)});let o=[...t.matchAll(Ge)].map(i=>i[0]);if(o.length>0){let i=o.map(a=>Ue(a));(0,We.default)(n,"timezones",i)}let s=[...t.matchAll(et)].map(i=>i[0]);if(s.length>0){let i=s.map(a=>ke(a,n.timezones));(0,We.default)(n,"events",i)}return n},dn=e=>Et.parse(Cr(e));var Pr=(e,t,r)=>({value:A(e,t,r),range:t==null?void 0:t.RANGE}),bn=(e,t,r)=>le.parse(Pr(e,t,r));var u=require("date-fns"),xt=(e,t)=>t.before?(0,u.subWeeks)((0,u.subDays)((0,u.subHours)((0,u.subMinutes)((0,u.subSeconds)(e,t.seconds||0),t.minutes||0),t.hours||0),t.days||0),t.weeks||0):(0,u.addWeeks)((0,u.addDays)((0,u.addHours)((0,u.addMinutes)((0,u.addSeconds)(e,t.seconds||0),t.minutes||0),t.hours||0),t.days||0),t.weeks||0),On=(e,t)=>{let r=Math.abs((0,u.differenceInWeeks)(t,e)),n=Math.abs((0,u.differenceInDays)(t,e)),o=n-r*7,s=Math.abs((0,u.differenceInHours)(t,e)),i=s-n*24,a=Math.abs((0,u.differenceInMinutes)(t,e)),c=a-s*60,l=Math.abs((0,u.differenceInSeconds)(t,e))-a*60;return{before:e>t,weeks:r,days:o,hours:i,minutes:c,seconds:l}};var Dn=e=>e.end?e.end.date:xt(e.start.date,e.duration);0&&(module.exports={DEFAULT_END_IN_YEARS,attendeePartStatusTypes,classTypes,dateObjectTypes,encodingTypes,extendByRecurrenceRule,extendTimezoneProps,generateIcsAlarm,generateIcsAttachment,generateIcsAttendee,generateIcsCalendar,generateIcsDate,generateIcsDateTime,generateIcsDuration,generateIcsEvent,generateIcsMail,generateIcsOrganizer,generateIcsRecurrenceRule,generateIcsTimeStamp,generateIcsTimezone,generateIcsTimezoneProp,generateIcsTrigger,generateIcsWeekdayNumber,getDurationFromInterval,getEventEnd,getEventEndFromDuration,getTimezoneObjectOffset,icsAlarmToObject,icsAttachmentToObject,icsAttendeeToObject,icsCalendarToObject,icsDateTimeToDateTime,icsDateToDate,icsDurationToObject,icsEventToObject,icsOrganizerToObject,icsRecurrenceIdToObject,icsRecurrenceRuleToObject,icsTimeStampToObject,icsTimezonePropToObject,icsTimezoneToObject,icsTriggerToObject,icsWeekdayNumberToObject,parseIcsAlarm,parseIcsAttachment,parseIcsAttendee,parseIcsCalendar,parseIcsDate,parseIcsDateTime,parseIcsDuration,parseIcsEvent,parseIcsOrganizer,parseIcsRecurrenceId,parseIcsRecurrenceRule,parseIcsTimezone,parseIcsTimezoneProp,parseIcsTrigger,parseIcsWeekdayNumber,parseicsTimeStamp,recurrenceObjectKeyIsNumber,recurrenceObjectKeyIsNumberArray,recurrenceObjectKeyIsTimeStamp,recurrenceObjectKeyIsWeekdayNumberArray,recurrenceRuleFrequencies,statusTypes,timeTransparentTypes,timeZoneOffsetToMilliseconds,timezonePropTypes,triggerRelations,valueTypes,weekDays,zAttachment,zAttendee,zDateObject,zDateObjectTzProps,zOrganizer,zRecurrenceId,zRecurrenceRule,zVAlarm,zVCalendar,zVCalendarMethods,zVEvent,zVEventBase,zVEventDuration,zVEventDurationOrEnd,zVEventTrigger,zVEventTriggerBase,zVEventTriggerOptions,zVEventTriggerUnion,zVTimezone,zVTimezoneProp,zWeekdayNumberObject});
